# VOPaaS Ansible

This is an ansible based installation project for the VOPaaS proxy server.

The ansible project contains a small set of roles:

* **nginx**: Installs and starts a nginx service. This can be used as an external SSL server for
the proxy.
* **install**: Installs all dependencies and python libraries for the vopaas proxy.
The role creates a virtual environment for the python libraries.
* **setup**: Copies all configuration files and adds a job configuration for easy start/stop/restart
of the proxy.
* **generate_metadata**: Generates SAML2 metadata from the proxy. 
Both for the backends and the frontends

# Setting up the installation

The ansible playbook **ansible/playbook.yml** contains global parameters for setting up
the installation.

* **installation_dir**: The location of where to put all the vopaas proxy files.
* **vopaas_env**: Where to save the virtual python environment containing the vopaas installation.
* **backend_metadata_location**: Defines where the backend metadata generated by the role 
**generate_metadata** will be written.
* **frontend_metadata_location**: Defines where the frontend metadata generated by the role 
**generate_metadata** will be written.
* **hostname**: What hostname to bind the proxy.
* **proxy_port**: The port to bind the proxy.
* **proxy_dir**: The location of the proxy execution directory.
    
# Start the proxy

The vopaas proxy is started using the job added by the setup role, by executing the command:
```
    sudo start vopaas_proxy
```

To restart the proxy:
```
    sudo restart vopaas_proxy
```

And to stop the proxy:
```
    sudo stop vopaas_proxy
```